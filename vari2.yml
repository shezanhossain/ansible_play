---
- name: Generate VLAN
  hosts: sw1
  connection: network_cli
  gather_facts: false
  
  tasks:
    - name: Set VLANs
      loop: "{{ (range(1, num_vlans + 1) | map('string')) | list }}"
      set_fact:
        vlan_msg: "create vlan {{ lookup('vars', 'VLAN_NAME_'+ item) }}"
      register: vlan_output

    - name: Save Output to File
      lineinfile:
        path: "{{ playbook_dir }}/output.txt"
        line: "{{ item }}"
        create: yes
      loop: "{{ vlan_output.results | map(attribute='ansible_facts.vlan_msg') | list }}"
